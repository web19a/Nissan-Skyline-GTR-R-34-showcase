<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dodge Challenger SRT Demon 170 - Detailed View</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #222;
            font-family: 'Arial', sans-serif;
        }
        canvas {
            display: block;
        }
        
        /* Control panel styling */
        .control-panel {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 10px;
            z-index: 100;
            backdrop-filter: blur(5px);
        }
        
        .part-btn {
            padding: 12px 20px;
            background: linear-gradient(to bottom, #444, #222);
            color: white;
            border: 2px solid #ff0000;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 100px;
            text-align: center;
        }
        
        .part-btn:hover {
            background: linear-gradient(to bottom, #ff0000, #aa0000);
            transform: translateY(-2px);
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.7);
        }
        
        .part-btn.active {
            background: linear-gradient(to bottom, #ff0000, #880000);
            box-shadow: 0 0 10px rgba(255, 100, 100, 0.8);
        }
        
        /* Info panel styling */
        .info-panel {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 300px;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #ff0000;
            transform: translateX(-350px);
            transition: transform 0.5s ease;
            z-index: 101;
            backdrop-filter: blur(5px);
        }
        
        .info-panel.visible {
            transform: translateX(0);
        }
        
        .info-panel h2 {
            margin-top: 0;
            color: #ff0000;
            border-bottom: 1px solid #444;
            padding-bottom: 10px;
        }
        
        .info-panel p {
            line-height: 1.5;
        }
        
        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }
        
        /* Loading indicator */
        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 24px;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 20px 40px;
            border-radius: 8px;
            z-index: 1000;
            border: 2px solid #ff0000;
        }
        
        /* Header styling */
        .header {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            text-align: center;
            z-index: 99;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 10px 30px;
            border-radius: 10px;
            border-bottom: 3px solid #ff0000;
        }
        
        .header h1 {
            margin: 0;
            font-size: 24px;
            color: #ff0000;
        }
        
        .header p {
            margin: 5px 0 0;
            font-size: 14px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Dodge Challenger SRT Demon 170</h1>
        <p>Select a part to explore</p>
    </div>
    
    <div class="control-panel">
        <button class="part-btn" data-part="overview">Overview</button>
        <button class="part-btn" data-part="engine">Engine</button>
        <button class="part-btn" data-part="tires">Tires</button>
        <button class="part-btn" data-part="body">Body</button>
        <button class="part-btn" data-part="interior">Interior</button>
    </div>
    
    <div class="info-panel" id="infoPanel">
        <button class="close-btn">&times;</button>
        <h2 id="panelTitle">Part Overview</h2>
        <div id="panelContent">
            <p>Select a part to view details about the Dodge Challenger SRT Demon 170.</p>
        </div>
    </div>
    
    <div class="loading" id="loadingIndicator">Loading model...</div>

    <script type="importmap">
        {
            "imports": {
                "three": "./scripts/three.module.js",
                "addons/": "./scripts/"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three'
        import {
            OrbitControls
        } from 'addons/OrbitControls.js';
        import {
            GLTFLoader
        } from 'addons/GLTFLoader.js';

        // SCENE SETUP
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(25, 10, 50); // Good starting camera position for a car

        const renderer = new THREE.WebGLRenderer({
            antialias: true
        });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        document.body.appendChild(renderer.domElement);

        // LIGHTS - Crucial for seeing the model's details
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);

        const directionalLight1 = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight1.position.set(10, 20, 15);
        scene.add(directionalLight1);

        const directionalLight2 = new THREE.DirectionalLight(0xffffff, 0.4);
        directionalLight2.position.set(-10, 10, -15);
        scene.add(directionalLight2);

        {
            const light = new THREE.RectAreaLight(0xff0000, 50, 1, 40);
            light.position.set(-7, 1, 0);
            light.rotation.x = THREE.MathUtils.degToRad(-90)
            scene.add(light);
        }

        {
            const light = new THREE.RectAreaLight(0xff0000, 50, 1, 40);
            light.position.set(7, 1, 0);
            light.rotation.x = THREE.MathUtils.degToRad(-90)
            scene.add(light);
        }

        {
            const light = new THREE.RectAreaLight(0xff0000, 50, 14, 1);
            light.position.set(0, 1, 20);
            light.rotation.x = THREE.MathUtils.degToRad(-90)
            scene.add(light);
        }

        {
            const light = new THREE.RectAreaLight(0xff0000, 50, 14, 1);
            light.position.set(0, 1, -20);
            light.rotation.x = THREE.MathUtils.degToRad(-90)
            scene.add(light);
        }

        for ( let i = -250; i <= 250; i += 20) {
            let geo = new THREE.PlaneGeometry(1, 10);
            let mat = new THREE.MeshStandardMaterial({
                color: 0xffffff
            })
            
            let mesh = new THREE.Mesh(geo, mat)
            mesh.position.set(0, .3, i)
            mesh.rotation.x = THREE.MathUtils.degToRad(-90)
            scene.add(mesh)
        }

        // CONTROLS
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.target.set(0, 0.5, 0); // Focus camera at the center of the car
        controls.enableDamping = true; // Adds a smooth "weight" to the controls
        controls.update();

        // FLOOR (Optional visual guide)
        const floorGeometry = new THREE.PlaneGeometry(60, 500);
        const floorMaterial = new THREE.MeshStandardMaterial({
            color: 0x222222,
            roughness: 0.8,
            metalness: 0.2
        });
        const floor = new THREE.Mesh(floorGeometry, floorMaterial);
        floor.rotation.x = -Math.PI / 2; // Rotate to be horizontal
        floor.position.y = -0.5; // Position it below the car
        scene.add(floor);

        const gridHelper = new THREE.GridHelper(20, 20, 0x222222, 0x222222);
        gridHelper.position.y = -0.49; // Just above the floor to avoid z-fighting
        //scene.add(gridHelper);

        // LOAD YOUR MODEL
        const loader = new GLTFLoader();
        let carModel;

        // !!! IMPORTANT: CHANGE THIS FILENAME TO MATCH YOUR .GLB FILE !!!
        loader.load(
            'models/demon_170.glb', // <--- EDIT THIS LINE

            function(gltf) {
                console.log("Model loaded successfully!");
                carModel = gltf.scene;
                scene.add(carModel);
                
                // Hide loading indicator
                document.getElementById('loadingIndicator').style.display = 'none';
                
                let useless = carModel.getObjectByName('Object_2');
                useless.position.y = 100000

                // Optional: Adjust model scale, rotation, or position if needed
                carModel.scale.set(0.5, 0.5, 0.5);
                carModel.position.set(-13, 0, 23);

            },
            function(xhr) {
                // Progress callback
                console.log((xhr.loaded / xhr.total * 100) + '% loaded');
            },
            function(error) {
                // Error callback
                console.error('An error happened while loading the model:', error);
                document.getElementById('loadingIndicator').textContent = 'Error loading model';
            }
        );

        // PART VIEWS AND DESCRIPTIONS
        const partInfo = {
            overview: {
                position: new THREE.Vector3(25, 10, 50),
                target: new THREE.Vector3(0, 0.5, 0),
                title: "Dodge Challenger SRT Demon 170",
                content: "The Dodge Challenger SRT Demon 170 is the most powerful production car ever made, with a 6.2L supercharged HEMI V8 engine producing 1,025 horsepower. It can accelerate from 0 to 60 mph in just 1.66 seconds and complete the quarter mile in 8.91 seconds at 151 mph."
            },
            engine: {
                position: new THREE.Vector3(0, 2, 8),
                target: new THREE.Vector3(0, 1.5, 5),
                title: "Supercharged HEMI V8 Engine",
                content: "The Demon 170's 6.2L supercharged HEMI V8 engine produces an astonishing 1,025 horsepower and 945 lb-ft of torque when running on E85 fuel. It features a larger 3.0L supercharger, high-flow fuel injection, and strengthened internals to handle the immense power."
            },
            tires: {
                position: new THREE.Vector3(5, 0.5, 3),
                target: new THREE.Vector3(5, 0.5, 3),
                title: "Performance Drag Radials",
                content: "Specially designed 18x11-inch wheels with Nitto NT05R drag radials provide the necessary grip for the Demon's explosive acceleration. The tires are 315/50R18 drag radials that can be inflated to 18.5 psi for optimal traction during drag racing."
            },
            body: {
                position: new THREE.Vector3(0, 2, 8),
                target: new THREE.Vector3(0, 1, 0),
                title: "Aerodynamic Body Design",
                content: "The Demon features a unique aerodynamic package with a functional air-grabber hood, widened fenders, and a distinct rear spoiler designed for optimal downforce at high speeds. The lightweight construction includes carbon fiber elements to reduce weight and improve performance."
            },
            interior: {
                position: new THREE.Vector3(0, 1.2, 2),
                target: new THREE.Vector3(0, 1, 5),
                title: "Driver-Focused Interior",
                content: "The interior features lightweight SRT performance seats, a performance steering wheel, and a dedicated Demon interface with performance pages. The rear seats have been removed to save weight, and the cabin includes specialized instrumentation for drag racing."
            }
        };

        // Set up button event listeners
        const partButtons = document.querySelectorAll('.part-btn');
        const infoPanel = document.getElementById('infoPanel');
        const panelTitle = document.getElementById('panelTitle');
        const panelContent = document.getElementById('panelContent');
        const closeBtn = document.querySelector('.close-btn');
        
        let activeButton = null;

        partButtons.forEach(button => {
            button.addEventListener('click', () => {
                const part = button.getAttribute('data-part');
                
                // Update active button styling
                if (activeButton) {
                    activeButton.classList.remove('active');
                }
                button.classList.add('active');
                activeButton = button;
                
                // Show info panel
                panelTitle.textContent = partInfo[part].title;
                panelContent.innerHTML = `<p>${partInfo[part].content}</p>`;
                infoPanel.classList.add('visible');
                
                // Move camera to the selected view
                if (partInfo[part]) {
                    // Smooth camera transition
                    const startPosition = camera.position.clone();
                    const startTarget = controls.target.clone();
                    const endPosition = partInfo[part].position;
                    const endTarget = partInfo[part].target;
                    
                    const duration = 1000; // ms
                    const startTime = Date.now();
                    
                    function animateCamera() {
                        const elapsed = Date.now() - startTime;
                        const progress = Math.min(elapsed / duration, 1);
                        
                        // Easing function for smooth animation
                        const ease = (t) => t<.5 ? 4*t*t*t : (t-1)*(2*t-2)*(2*t-2)+1;
                        
                        camera.position.lerpVectors(startPosition, endPosition, ease(progress));
                        controls.target.lerpVectors(startTarget, endTarget, ease(progress));
                        controls.update();
                        
                        if (progress < 1) {
                            requestAnimationFrame(animateCamera);
                        }
                    }
                    
                    animateCamera();
                }
            });
        });

        // Close button for info panel
        closeBtn.addEventListener('click', () => {
            infoPanel.classList.remove('visible');
        });

        // ANIMATION LOOP
        function animate() {
            requestAnimationFrame(animate);
            controls.update(); // Required if controls.enableDamping = true
            renderer.render(scene, camera);
        }
        animate();

        // HANDLE WINDOW RESIZE
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

    </script>
</body>
</html>